---
import Layout from '@layouts/Default.astro';
import LatestEpisode from '@components/episodes/LatestEpisode.astro';
import RecentEpisodes from '@components/episodes/RecentEpisodes.astro';
import MobileSocials from '@components/home/MobileSocials.astro';
import { Pill, Button, Card } from '@eliancodes/brutal-ui';
import { getCollection } from 'astro:content';

// Get the latest episode
const allEpisodes = await getCollection('episodes');
const sortedEpisodes = allEpisodes
  .filter(ep => !ep.data.draft)
  .sort((a, b) => b.data.pubDate.getTime() - a.data.pubDate.getTime());
const latestEpisode = sortedEpisodes[0];

const podcastFeatures = [
  'Board Games',
  'Conversations',
  'Under 30 mins',
  'Diverse Guests',
  'Fun & Insightful',
];
---

<Layout
  title='Home'
  pageTitle='Between The Turns | A Board Game Podcast'
  description='Fun, insightful, energetic conversations under 30 minutes with interesting people while playing board games. Part of Board Game Company.'
>
  <main class='bg-cream p-4 sm:p-6'>
    <MobileSocials />

    {latestEpisode && (
      <section id='latest' class='mt-4'>
        <LatestEpisode episode={latestEpisode} />
      </section>
    )}

    <section id='about' class='grid grid-cols-1 md:grid-cols-8 gap-4 sm:gap-6 mt-6 sm:mt-8'>
      <h2 class='hidden'>About Between The Turns</h2>

      <div class='col-span-1 md:col-span-4'>
        <Card color='blue'>
          <div class='flex flex-col justify-between items-start gap-3 sm:gap-4'>
            <p class='mt-2 sm:mt-4 outfit text-xl sm:text-2xl md:text-4xl lg:text-5xl text-white'>
              Conversations that happen
              <span class='text-yellow'>between the turns</span>
            </p>
            <p class='mt-1 sm:mt-2 poppins text-base sm:text-lg md:text-xl text-white opacity-90'>
              Fun, insightful, energetic conversations under 30 minutes with
              interesting, creative, technical, and diverse people — all while
              playing board games.
            </p>
            <Button target='_self' href='/about/'>
              Learn More &rarr;
            </Button>
          </div>
        </Card>
      </div>

      <div class='col-span-1 md:col-span-2'>
        <Card color='yellow'>
          <h2 class='text-xl sm:text-2xl md:text-3xl lg:text-4xl mb-4 sm:mb-6 dm-serif'>
            What to expect
          </h2>
          <ul class='flex gap-2 sm:gap-3 flex-wrap'>
            {
              podcastFeatures.map((feature) => (
                <li>
                  <Pill>
                    <span class='sanchez text-xs sm:text-sm'>{feature}</span>
                  </Pill>
                </li>
              ))
            }
          </ul>
        </Card>
      </div>

      <div class='col-span-1 md:col-span-2'>
        <Card color='purple'>
          <h2 class='text-xl sm:text-2xl md:text-3xl lg:text-4xl mb-3 sm:mb-4 dm-serif text-white'>
            Part of BGC
          </h2>
          <p class='poppins text-sm sm:text-base text-white opacity-90'>
            Between The Turns is brought to you by
            <a
              href='https://boardgamecompany.in'
              target='_blank'
              class='underline font-semibold'
            >
              Board Game Company
            </a>
            — a community of board game enthusiasts in India.
          </p>
          <div class='mt-3 sm:mt-4'>
            <a
              href='https://instagram.com/boardgamecompany'
              target='_blank'
              class='inline-flex items-center gap-2 text-white hover:text-yellow transition-colors'
            >
              <div class='i-uil-instagram w-5 h-5' />
              <span class='poppins text-sm sm:text-base'>@boardgamecompany</span>
            </a>
          </div>
        </Card>
      </div>
    </section>

    <RecentEpisodes count={3} excludeLatest={true} />
  </main>
</Layout>
